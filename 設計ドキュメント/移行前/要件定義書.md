# 要件定義書（移行前：Azure Databricks + Azure ADLS）

## 1. プロジェクト概要

### 1.1 プロジェクト名
Northwind データレイクハウス構築プロジェクト（移行前フェーズ）

### 1.2 目的
- Unity Catalog を活用したデータガバナンス基盤の構築
- メダリオンアーキテクチャ（Bronze/Silver/Gold）によるデータ管理
- ETLパイプラインの自動化

### 1.3 スコープ

| 項目 | 移行前（本フェーズ） | 移行後 |
|------|---------------------|--------|
| Databricks環境 | Azure Databricks | AWS Databricks |
| データレイク | Azure ADLS Gen2 | AWS S3 |
| ソースDB | AWS RDS (PostgreSQL) | AWS RDS (同一VPC) |

---

## 2. 機能要件

### 2.1 データ取り込み（Ingest）
- [ ] AWS RDS (Northwind) からのJDBC接続によるデータ抽出
- [ ] Bronze層へのDelta Lake形式での保存
- [ ] 増分更新（日次バッチ）

### 2.2 データ変換（Transform）
- [ ] Silver層：クレンジング・標準化
- [ ] Gold層：集計・マート作成

### 2.3 データガバナンス
- [ ] Unity Catalog によるメタデータ管理
- [ ] リネージ追跡
- [ ] アクセス制御

---

## 3. 非機能要件

### 3.1 パフォーマンス
| 項目 | 要件 |
|------|------|
| 日次バッチ処理時間 | 1時間以内 |
| データ量 | 〜10GB/日（学習用のため小規模） |

### 3.2 セキュリティ
| 項目 | 要件 |
|------|------|
| 認証方式 | Managed Identity（ADLS）, SSL（RDS） |
| データ暗号化 | 保存時・転送時ともに暗号化 |

### 3.3 可用性
| 項目 | 要件 |
|------|------|
| 目標稼働率 | 99%（学習用のため緩め） |

---

## 4. 対象テーブル一覧

| テーブル名 | 説明 | 件数目安 |
|-----------|------|---------|
| customers | 顧客マスタ | 〜100件 |
| orders | 受注データ | 〜1,000件 |
| order_details | 受注明細 | 〜5,000件 |
| products | 商品マスタ | 〜100件 |
| categories | カテゴリマスタ | 〜10件 |
| suppliers | 仕入先マスタ | 〜30件 |
| employees | 従業員マスタ | 〜10件 |
| shippers | 配送業者マスタ | 〜5件 |

---

## 5. 制約事項

1. Azure Databricks から AWS S3 への書き込みは不可（IAMロールが読み取り専用に制限）
2. データレイクは Azure ADLS Gen2 を使用（上記制約への対応）
3. RDSへのアクセスはインターネット経由（パブリックエンドポイント）

---

## 変更履歴

| 日付 | 変更内容 |
|------|----------|
| 2026-02-09 | 初版作成 |
