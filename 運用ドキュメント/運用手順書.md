# 運用手順書

## 1. 概要

本書はNorthwindデータレイクハウスの日次運用手順を記載します。

---

## 2. 日次バッチ実行

### 2.1 手動実行

Databricks Workspace で以下の順番でNotebookを実行：

1. `02_etl_bronze_ingest.py`
2. `03_etl_silver_transform.py`
3. `04_etl_gold_aggregate.py`

### 2.2 スケジュール実行（推奨）

Databricks Jobsでワークフローを作成：

```
Job名: northwind_daily_etl
スケジュール: 毎日 AM 6:00 (JST)
タスク:
  1. Bronze Ingest
  2. Silver Transform（1の完了後）
  3. Gold Aggregate（2の完了後）
```

---

## 3. 監視項目

### 3.1 ジョブ実行状況

| 確認項目 | 確認方法 | 閾値 |
|---------|---------|------|
| ジョブ成功率 | Databricks Jobs UI | 100% |
| 実行時間 | Databricks Jobs UI | 1時間以内 |

### 3.2 データ品質

| 確認項目 | 確認方法 | 閾値 |
|---------|---------|------|
| Null率 | DQテーブル | 5%以下 |
| 重複件数 | DQテーブル | 0件 |

---

## 4. アラート対応

### 4.1 ジョブ失敗時

1. Databricks Jobs UIでエラーログ確認
2. トラブルシューティングガイド参照
3. 必要に応じて再実行

### 4.2 データ品質異常時

1. DQテーブルで詳細確認
2. ソースデータ確認
3. 必要に応じて再取り込み

---

## 5. 定期メンテナンス

| 作業 | 頻度 | 手順 |
|------|------|------|
| ログ削除 | 月次 | 30日以上前のログを削除 |
| テーブル最適化 | 週次 | OPTIMIZE コマンド実行 |
| バキューム | 週次 | VACUUM コマンド実行 |

---

## 変更履歴

| 日付 | 変更内容 |
|------|----------|
| 2026-02-09 | 初版作成 |
